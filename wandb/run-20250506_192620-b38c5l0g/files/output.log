Reward: 0.00:   0%|‚ñè                                                                                                                                                                        | 140/100000 [00:11<2:19:05, 11.97it/s]
Traceback (most recent call last):
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/main.py", line 148, in <module>
    agent.train_step(global_step)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/agents/drnd_ppo_agent.py", line 117, in train_step
    self.drnd.update(next_obs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/exploration/drnd_ppo.py", line 81, in update
    grads = jax.grad(loss_fn)(self.train_state.params)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 182, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/api.py", line 437, in grad_f
    _, g = value_and_grad_f(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 182, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/api.py", line 508, in value_and_grad_f
    ans, vjp_py = _vjp(f_partial, *dyn_args)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/api.py", line 2066, in _vjp
    out_primals, vjp = ad.vjp(flat_fun, primals_flat)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/ad.py", line 284, in vjp
    out_primals, pvals, jaxpr, consts = linearize(traceable, *primals)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/ad.py", line 269, in linearize
    jaxpr, out_pvals, consts = pe.trace_to_jaxpr_nounits(jvpfun_flat, in_pvals)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/profiler.py", line 334, in wrapper
    return func(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 602, in trace_to_jaxpr_nounits
    jaxpr, (out_pvals, consts, env) = fun.call_wrapped(pvals)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/linear_util.py", line 211, in call_wrapped
    return self.f_transformed(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 616, in trace_to_subjaxpr_nounits
    out_tracers, jaxpr, out_consts, env = _trace_to_subjaxpr_nounits(
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/partial_eval.py", line 649, in _trace_to_subjaxpr_nounits
    ans = f(*in_args)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/api_util.py", line 73, in flatten_fun
    ans = f(*py_args, **py_kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/ad.py", line 80, in jvpfun
    out_primals, out_tangents = f(tag, primals, tangents)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/interpreters/ad.py", line 133, in jvp_subtrace
    ans = f(*in_tracers)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/api_util.py", line 90, in flatten_fun_nokwargs
    ans = f(*py_args)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/api_util.py", line 288, in _argnums_partial
    return _fun(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/linear_util.py", line 402, in _get_result_paths_thunk
    ans = _fun(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/exploration/drnd_ppo.py", line 75, in loss_fn
    selected_targets = jnp.stack([self.target_networks[i].apply(self.target_params[i], obs[i:i+1])[0] for i in idx])
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/exploration/drnd_ppo.py", line 75, in <listcomp>
    selected_targets = jnp.stack([self.target_networks[i].apply(self.target_params[i], obs[i:i+1])[0] for i in idx])
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/jax/_src/traceback_util.py", line 182, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/flax/linen/module.py", line 2239, in apply
    method = _get_unbound_fn(method)
  File "/Users/albertomoreno/Documents/Universidad/Year3/RP/EpistemicUncertaintyRL/.venv/lib/python3.10/site-packages/flax/linen/module.py", line 765, in _get_unbound_fn
    or len(inspect.signature(method_or_fn).parameters) < 1
  File "/Users/albertomoreno/.local/share/uv/python/cpython-3.10.17-macos-aarch64-none/lib/python3.10/inspect.py", line 3254, in signature
    return Signature.from_callable(obj, follow_wrapped=follow_wrapped,
  File "/Users/albertomoreno/.local/share/uv/python/cpython-3.10.17-macos-aarch64-none/lib/python3.10/inspect.py", line 3002, in from_callable
    return _signature_from_callable(obj, sigcls=cls,
  File "/Users/albertomoreno/.local/share/uv/python/cpython-3.10.17-macos-aarch64-none/lib/python3.10/inspect.py", line 2463, in _signature_from_callable
    return _signature_from_function(sigcls, obj,
  File "/Users/albertomoreno/.local/share/uv/python/cpython-3.10.17-macos-aarch64-none/lib/python3.10/inspect.py", line 2307, in _signature_from_function
    annotations = get_annotations(func, globals=globals, locals=locals, eval_str=eval_str)
  File "/Users/albertomoreno/.local/share/uv/python/cpython-3.10.17-macos-aarch64-none/lib/python3.10/inspect.py", line 66, in get_annotations
    def get_annotations(obj, *, globals=None, locals=None, eval_str=False):
KeyboardInterrupt
